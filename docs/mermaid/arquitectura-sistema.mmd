%%{init: {'theme':'default'}}%%
graph TB
    subgraph Cliente["ğŸŒ CLIENTE"]
        Browser["Navegador Web"]
        APIClient["API Client"]
        App["AplicaciÃ³n"]
    end
    
    subgraph API["âš™ï¸ API REST (Node.js + Express)"]
        GuardarCtrl["Guardar Controller"]
        LeerCtrl["Leer Controller"]
        MetricsRoute["MÃ©tricas Routes"]
    end
    
    subgraph Fabric["â›“ï¸ Hyperledger Fabric"]
        subgraph LightCh["Light Channel"]
            LightCC["jsonstoragemodel<br/>chaincode"]
        end
        subgraph HeavyCh["Heavy Channel"]
            HeavyCC["jsonstoragemodel<br/>chaincode"]
        end
        Wallet["ğŸ” Wallet<br/>Admin@org1.example.com"]
    end
    
    subgraph DB["ğŸ—„ï¸ MySQL Database"]
        LightTable["light_model_data<br/>(JSON + metadata)"]
        HeavyTable["heavy_model_data<br/>(solo metadata)"]
    end
    
    subgraph Monitoring["ğŸ“Š Monitoring"]
        Prometheus["Prometheus<br/>Metrics Server"]
    end
    
    Browser --> API
    APIClient --> API
    App --> API
    
    GuardarCtrl --> LightCC
    GuardarCtrl --> HeavyCC
    GuardarCtrl --> LightTable
    GuardarCtrl --> HeavyTable
    
    LeerCtrl --> LightCC
    LeerCtrl --> HeavyCC
    LeerCtrl --> LightTable
    
    MetricsRoute --> Prometheus
    
    LightCC -.-> LightTable
    HeavyCC -.-> HeavyTable
    
    Wallet -.autenticaciÃ³n.-> LightCC
    Wallet -.autenticaciÃ³n.-> HeavyCC
    
    style Cliente fill:#e1f5ff
    style API fill:#fff4e1
    style Fabric fill:#f0e1ff
    style DB fill:#e1ffe1
    style Monitoring fill:#ffe1e1
    style LightCC fill:#a8d5ff
    style HeavyCC fill:#ffa8d5
